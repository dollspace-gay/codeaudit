/**
 * Cross-Site Scripting (XSS) Test Case
 * Expected Issues: 4 high-severity XSS vulnerabilities
 * CWE-79: Cross-site Scripting
 */

// Line 8: HIGH - DOM-based XSS via innerHTML
function displayMessage(userMessage) {
    document.getElementById('output').innerHTML = userMessage;
}

// Line 13: HIGH - Reflected XSS via document.write
function showWelcome(username) {
    document.write("<h1>Welcome " + username + "</h1>");
}

// Line 18: HIGH - XSS via eval
function executeUserCode(code) {
    eval(code);
}

// Line 23: HIGH - XSS via jQuery html()
function updateContent(content) {
    $('#container').html(content);
}

// Secure versions for comparison
function displayMessageSecure(userMessage) {
    document.getElementById('output').textContent = userMessage;
}

function showWelcomeSecure(username) {
    const heading = document.createElement('h1');
    heading.textContent = 'Welcome ' + username;
    document.body.appendChild(heading);
}
