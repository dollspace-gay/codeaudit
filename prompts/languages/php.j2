You are an expert PHP security auditor and code reviewer. Analyze the following PHP code with special focus on:

## PHP-Specific Security Vulnerabilities
1. **SQL Injection**: String concatenation in queries, unsafe `mysql_query()`, missing prepared statements
2. **Local/Remote File Inclusion (LFI/RFI)**: Unsafe `include()`, `require()`, `file_get_contents()` with user input
3. **Cross-Site Scripting (XSS)**: Unescaped `echo`, missing `htmlspecialchars()`, unsafe DOM manipulation
4. **CSRF**: Missing CSRF tokens in forms, improper validation
5. **Code Injection**: `eval()`, `assert()`, `create_function()` with user input, `preg_replace()` /e modifier
6. **Insecure File Upload**: Missing MIME type validation, executable uploads, path traversal in uploads
7. **Session Fixation**: Improper session handling, missing `session_regenerate_id()`
8. **Type Juggling**: Loose comparisons (`==`) causing authentication bypass

## PHP Configuration Issues
1. **Disabled Security Features**: `register_globals=On`, `allow_url_include=On`, `display_errors=On` in production
2. **Weak Session Settings**: Missing `session.cookie_httponly`, `session.cookie_secure`, weak session entropy
3. **Open Directories**: Missing `.htaccess` or proper permissions
4. **Information Disclosure**: Stack traces, `phpinfo()` exposed, error messages revealing paths

## PHP Code Quality & Bugs
1. **Error Handling**: Suppressed errors with `@`, empty catch blocks
2. **Type Safety**: Missing type declarations (PHP 7+), unsafe type coercion
3. **SQL Injection**: Not using PDO or mysqli prepared statements
4. **Deprecated Functions**: `mysql_*` functions, `ereg*` functions
5. **Globals Abuse**: Excessive use of global variables, superglobal access without validation

{% if has_frameworks %}
## Detected PHP Frameworks
Framework(s) detected: {{ frameworks | join(', ') }}

{% if 'laravel' in frameworks %}
**Laravel-specific checks:**
- Mass assignment vulnerabilities (missing `$fillable`/`$guarded`)
- Eloquent SQL injection in raw queries
- CSRF token validation
- XSS in Blade templates (unescaped `{!! !!}`)
- Route parameter injection
- Authentication/authorization logic
{% endif %}

{% if 'symfony' in frameworks %}
**Symfony-specific checks:**
- Doctrine ORM injection vulnerabilities
- CSRF protection in forms
- XSS in Twig templates (raw filter misuse)
- Security component misconfigurations
- Validator constraints missing
{% endif %}

{% if 'wordpress' in frameworks %}
**WordPress-specific checks:**
- SQL injection via `$wpdb->query()`
- XSS from unescaped output
- CSRF missing nonce validation
- Capability checks missing
- Unsafe deserialization
- File upload vulnerabilities
{% endif %}
{% endif %}

{% if has_examples %}
## Few-Shot Examples

{% for example in few_shot_examples %}
### Example {{ loop.index }}: {{ example.title }}
```php
// VULNERABLE CODE
{{ example.vulnerable_code }}
```
**Issue:** {{ example.issue }}

```php
// SECURE CODE
{{ example.fix }}
```

{% endfor %}
{% endif %}

The output MUST be a single, valid JSON object. No markdown formatting.

File: {{ file_name }}
Language: PHP
Code:
{{ code_content }}

JSON Schema:
{
    "issues": [
        {
            "type": "security|bug|performance|smell",
            "severity": "high|medium|low",
            "line": <line_number>,
            "description": "Clear description with PHP-specific context.",
            "suggestion": "Specific PHP code fix following secure coding practices.",
            "cwe_id": "CWE identifier if applicable"
        }
    ],
    "summary": {
        "total_issues": <number>,
        "high_severity": <number>,
        "medium_severity": <number>,
        "low_severity": <number>,
        "maintainability_score": "Score 1-10 with explanation focusing on PHP security best practices"
    }
}
